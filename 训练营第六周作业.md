`题目1`
一条sql语句在Mysql中如何执行  
1.客户端发起请求，通过连接器连接到mySQL服务端上。  
2.MySQL会使用检查缓存，如果该语句在mysql的缓存上的话，就会直接返回，但是我经历过3个公司都没有开启mysql的缓存机制。通常使用redis为中间件进行缓存，当然在流量大的情况下，会使用java的本地缓存进行缓存，在多服务的情况下，使用本地缓存有可能会存在数据短暂性不同步的情况。    
3.然后进入查询阶段，先对sql语句进行编译的过程，词法解析（把一个完整的sql分割成字符串）、语法解析（判断是否符合MySQL的语法，生成解析树）、预处理器（检查语句，检验用户是否有权限进行操作），预处理后会得到一个新的解析树继续进行处理。  
4.进入优化器，MySQL会对sql语句进行优化操作，但是优化的操作并不完全是最佳的，优化器有可能会导致负优化的情况发生。  
5.MySQL调用执行器，先判断用户是否有操作表的权限，如果有的话调用存储引擎接口开始查询，最后返回结果到客户端。

Innodb存储引擎过程解析  
insert/update语句：  
1.开启事务
2.根据innodb_flush_log_at_trx_commit参数设置的不一样，这个时候有3种情况：  
&emsp;&emsp;2.1.事务提交的时候，不立即把LogBuffer的数据写入发哦redo log上，等待主线程每秒写入一次  
&emsp;&emsp;2.2.每次事务提交时，会将数据从LogBuffer写入OS Buff上，并同时刷盘  
&emsp;&emsp;2.3.事务提交时，将数据写入到OS Buff，由操作系统执行刷盘操作。  
3.修改缓存区中的页。这个时候会产生脏页  
4.MySQL使用Checkponit机制进行脏页落盘在数据库运行正常的环境下面，用的是Fuzzy Checkpoint  
&emsp;&emsp;4.1.主线程以一个固定的频率进行脏页的刷盘。  
&emsp;&emsp;4.2.使用LRU算法强制执行刷盘。  
&emsp;&emsp;4.3.脏页数据太多，强行刷盘。 
&emsp;&emsp;4.4.redo Log所占用的空间已经达到了设定阈值，为了redo Log可以循环使用，也会进行刷盘。这个时候会阻塞写入的线程等到脏页刷新完毕，但是不会阻塞查询的线程。  
5.脏页刷新不会直接写磁盘，会先把脏页复制到内存的Double buffer，先把Double buffer写入系统共享表空间的物理磁盘，并同步OS缓存到磁盘，
6.内存的double buffer最后将页写入各自表空间文件中。

select语句：  
1.开启事务  
2.InnoDB判断事务的隔离级别，如果是serializable就判断当前表是否有锁，如有则等待  
3.RR、RC级别使用的是MVCC多版本并发控制，读不加锁，根据隔离级别获取快照  
4.查询语句是否能够命中索引，如果是，走索引流程，如果是主键索引，直接可以查出数据，如果是二级索引，就要看是否有覆盖索引，如果有，直接返回数据，如果没有，则可以根据索引查出主键后回表查询数据。

`题目2`请解释一下你理解的事务是什么  
事务是一个工程逻辑执行的一个系列的操作。符合4个特性，ACID。  
A：Atomicity，原子性，事务中的系列操作是不可分割，要么全部成功，要么全部失败。如果后面的操作失败，就要前面的操作需要进行回滚处理。  
C：Consistency，一致性，事务操作完成前后的现象是需要跟预期相符合。  
I：Isolation，隔离性，多个事务并发执行的时候，一个事务的执行不能影响到其他事务的执行。  
D：Durability，持久性事务处理完成后，对数据的修改是永久的。  

事务的并发问题有以下几个
1.脏读：一个事务读到了另一个事务未提交的数据。  
2.不可重复读：一个事务读到了另一个事务已经提交的数据。导致同一个事务中的多次相关语句查询结果不一致。  
3.幻读：一个事务读到了另一个数据插入的数据。导致同一个事务中的多次相关语句查询结果数量不一致。  
4.两个事务在并发下同时进行更新,后一个事务的更新覆盖了前一个事务更新





